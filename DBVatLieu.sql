CREATE DATABASE VatLieu
USE VatLieu
CREATE TABLE Account(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
ChucVu INT NOT NULL,
TrangThai INT NOT NULL,
HoTen NVARCHAR(300) NOT NULL,
NgaySinh DATE NOT NULL,
GioiTinh BIT NOT NULL,
SDT NVARCHAR(12) NOT NULL,
DiaChi NVARCHAR(MAX) NOT NULL,
Email NVARCHAR(300) NOT NULL,
Username NVARCHAR(200) NOT NULL,
[Password] NVARCHAR(200) NOT NULL,
NgayTao DATE NOT NULL,
NguoiTao UNIQUEIDENTIFIER NOT NULL,
NgayChinhSua DATE,
NguoiChinhSua UNIQUEIDENTIFIER
)
CREATE TABLE KhachHang(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
HoTen NVARCHAR(300) NOT NULL,
NgaySinh DATE NOT NULL,
GioiTinh BIT NOT NULL,
SDT NVARCHAR(12) NOT NULL,
DiaChi NVARCHAR(MAX) NOT NULL,
Email NVARCHAR(300) NOT NULL,
NgayTao DATE NOT NULL,
NguoiTao UNIQUEIDENTIFIER NOT NULL,
NgayChinhSua DATE,
NguoiChinhSua UNIQUEIDENTIFIER
)
CREATE TABLE SanPham(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma NVARCHAR(20) NOT NULL,
TenSP NVARCHAR(300) NOT NULL,
NgayTao DATE NOT NULL,
)
CREATE TABLE Loai(
Id INT IDENTITY(1,1) NOT NULL PRIMARY KEY,
Ma NVARCHAR(20) NOT NULL,
Ten NVARCHAR(300) NOT NULL,
)
CREATE TABLE Hang(
Id INT IDENTITY(1,1) NOT NULL PRIMARY KEY,
Ma NVARCHAR(20) NOT NULL,
Ten NVARCHAR(300) NOT NULL,
)
CREATE TABLE ChiTietSanPham(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdSP UNIQUEIDENTIFIER NOT NULL,
IdHang INT NOT NULL,
IdLoai INT NOT NULL,
DonViTinh NVARCHAR(100) NOT NULL,
SoLuongTon INT NOT NULL,
GiaNhap MONEY NOT NULL,
GiaBan MONEY NOT NULL,
NgayNhap DATE NOT NULL,
NgayChinhSua DATE,
CONSTRAINT FK_IdSP FOREIGN KEY (IdSP) REFERENCES SanPham(Id),
CONSTRAINT FK_IdHang FOREIGN KEY (IdHang) REFERENCES Hang(Id),
CONSTRAINT FK_IdLoaiSP FOREIGN KEY (IdLoai) REFERENCES Loai(Id),
)
CREATE TABLE TrangThaiOrder(
Id INT IDENTITY(1,1) NOT NULL PRIMARY KEY,
Ma NVARCHAR(100) NOT NULL,
Ten NVARCHAR(200) NOT NULL
)
CREATE TABLE HoaDon(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdAcc UNIQUEIDENTIFIER NOT NULL,
IdKH UNIQUEIDENTIFIER,
IdTT INT NOT NULL,
NgayTao DATE NOT NULL,
NgayThanhToan DATE,
NgayShip DATE,
NgayKhachNhan DATE,
TongTien MONEY NOT NULL,
NgayChinhSua DATE,
NguoiChinhSua UNIQUEIDENTIFIER
CONSTRAINT FK_IdAcc FOREIGN KEY (IdAcc) REFERENCES Account(Id),
CONSTRAINT FK_IdKH FOREIGN KEY (IdKH) REFERENCES KhachHang(Id),
CONSTRAINT FK_IdTTO FOREIGN KEY (IdTT) REFERENCES TrangThaiOrder(Id),
)
CREATE TABLE HoaDonChiTiet(
IdCTSP UNIQUEIDENTIFIER NOT NULL,
IdHoaDon UNIQUEIDENTIFIER NOT NULL,
TenSP NVARCHAR(300) NOT NULL,
Hang NVARCHAR(300) NOT NULL,
Loai NVARCHAR(300) NOT NULL,
SoLuong INT NOT NULL,
DonGia MONEY NOT NULL
CONSTRAINT PK_IdCTSP_IdHD PRIMARY KEY (IdCTSP,IdHoaDon),
CONSTRAINT FK_IdCTSP FOREIGN KEY (IdCTSP) REFERENCES ChiTietSanPham(Id),
CONSTRAINT FK_IdHD FOREIGN KEY (IdHoaDon) REFERENCES HoaDon(Id)
)
CREATE TABLE GioHang(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdKH UNIQUEIDENTIFIER,
NgayTao DATE NOT NULL,
NgayThanhToan DATE,
TongTien MONEY NOT NULL
CONSTRAINT FK_IdKH FOREIGN KEY (IdKH) REFERENCES KhachHang(Id),
)
)
CREATE TABLE GioHangChiTiet(
IdCTSP UNIQUEIDENTIFIER NOT NULL,
IdHoaDon UNIQUEIDENTIFIER NOT NULL,
TenSP NVARCHAR(300) NOT NULL,
Hang NVARCHAR(300) NOT NULL,
Loai NVARCHAR(300) NOT NULL,
SoLuong INT NOT NULL,
DonGia MONEY NOT NULL
CONSTRAINT PK_IdCTSP_IdHD PRIMARY KEY (IdCTSP,IdHoaDon),
CONSTRAINT FK_IdCTSP FOREIGN KEY (IdCTSP) REFERENCES ChiTietSanPham(Id),
CONSTRAINT FK_IdHD FOREIGN KEY (IdHoaDon) REFERENCES HoaDon(Id)
)